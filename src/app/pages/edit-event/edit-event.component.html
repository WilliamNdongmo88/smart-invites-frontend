    <div class="edit-event">

    <!-- Indicateur de chargement -->
    <app-spinner [isLoading]="isLoading"></app-spinner>

      <!-- Header -->
      <div class="edit-event-header">
        <div class="container">
          <a routerLink="/evenements" class="back-link">‚Üê Retour au tableau de bord</a>
          <h1>Modifier l'√©v√©nement</h1>
          <p>Mettez √† jour les d√©tails de votre √©v√©nement</p>
        </div>
      </div>

      <!-- Main content -->
      <div class="container py-12">
        <div class="form-wrapper">
          <form (ngSubmit)="onSubmit()" #eventForm="ngForm">
            <!-- Step indicator -->
            <div class="step-indicator">
              <div class="step" [class.active]="currentStep() === 1" [class.completed]="currentStep() > 1">
                <span>1</span>
                <p>Informations</p>
              </div>
              <div class="step-line" [class.completed]="currentStep() > 1"></div>
              <div class="step" [class.active]="currentStep() === 2" [class.completed]="currentStep() > 2">
                <span>2</span>
                <p>D√©tails</p>
              </div>
              <div class="step-line" [class.completed]="currentStep() > 2"></div>
              <div class="step" [class.active]="currentStep() === 3">
                <span>3</span>
                <p>Confirmation</p>
              </div>
            </div>

            <!-- Step 1: Basic Information -->
            <div *ngIf="currentStep() === 1" class="step-content">
              <h2>Informations de base</h2>

              <div class="form-group">
                <label for="eventTitle">Titre de l'√©v√©nement</label>
                <input
                  type="text"
                  id="eventTitle"
                  name="eventTitle"
                  [(ngModel)]="eventData.title"
                  placeholder="Ex: Mariage de Sophie et Pierre"
                  required
                  class="form-input"
                />
              </div>

              <div class="form-group">
                <label for="eventDate">Date de l'√©v√©nement</label>
                <input
                  type="date"
                  id="eventDate"
                  name="eventDate"
                  [(ngModel)]="eventData.date"
                  required
                  class="form-input"
                />
              </div>

              <div class="form-group">
                <label for="eventTime">Heure de l'√©v√©nement</label>
                <input
                  type="time"
                  id="eventTime"
                  name="eventTime"
                  [(ngModel)]="eventData.time"
                  required
                  class="form-input"
                />
              </div>

              <div *ngIf="showWeddingCivilLocation" class="form-group">
                <label for="eventCivilLocation">Lieu de c√©l√©bration du mariage civil</label>
                <input
                  type="text"
                  id="eventCivilLocation"
                  name="eventCivilLocation"
                  [(ngModel)]="eventData.civilLocation"
                  placeholder="Ex: H√¥tel de ville de Bafoussam"
                  required
                  class="form-input"
                />
              </div>

              <!-- Checkbox -->
              <div *ngIf="showWeddingCivilLocation" class="form-group checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    [(ngModel)]="eventData.showWeddingReligiousLocation"
                    name="hasReligiousCeremony"
                  />
                  C√©r√©monie religieuse
                </label>
              </div>

              <!-- Formulaire c√©r√©monie religieuse -->
              <div *ngIf="eventData.showWeddingReligiousLocation">
                <div class="form-group">
                  <label for="eventReligiousLocation">
                    Lieu de la C√©r√©monie Religieuse
                  </label>
                  <input
                    type="text"
                    id="eventReligiousLocation"
                    name="eventReligiousLocation"
                    [(ngModel)]="eventData.religiousLocation"
                    placeholder="Ex: √âglise Saint Pierre de Bafoussam"
                    class="form-input"
                  />
                </div>

                <div class="form-group">
                  <label for="eventReligiousTime">Heure de la c√©r√©monie</label>
                  <input
                    type="time"
                    id="eventReligiousTime"
                    name="eventReligiousTime"
                    [(ngModel)]="eventData.religiousTime"
                    class="form-input"
                  />
                </div>
              </div>

              <div class="form-group">
                <label *ngIf="showWeddingCivilLocation" for="eventLocation">Lieu du Banquet de Mariage</label>
                <label *ngIf="!showWeddingCivilLocation" for="eventLocation">Lieu de l'√©v√©nement</label>
                <input
                  type="text"
                  id="eventLocation"
                  name="eventLocation"
                  [(ngModel)]="eventData.location"
                  placeholder="Ex: Ch√¢teau de Versailles, √éle-de-France"
                  required
                  class="form-input"
                />
              </div>
              <div *ngIf="showWeddingCivilLocation" class="form-group">
                <label for="eventBanquetTime">Heure du Banquet</label>
                <input
                  type="time"
                  id="eventBanquetTime"
                  name="eventBanquetTime"
                  [(ngModel)]="eventData.banquetTime"
                  required
                  class="form-input"
                />
              </div>

              <div class="form-group">
                <label for="eventType">Type d'√©v√©nement</label>
                <select
                  id="eventType"
                  name="eventType"
                  [(ngModel)]="eventData.type"
                  (change)="showSelection()"
                  class="form-input"
                >
                  <option value="">S√©lectionner un type</option>
                  <option value="wedding">Mariage</option>
                  <option value="engagement">Fian√ßailles</option>
                  <option value="anniversary">Anniversaire de Mariage</option>
                  <option value="birthday">Anniversaire</option>
                  <option value="other">Autre</option>
                </select>
              </div>

              <!-- Status -->
              <div class="form-group">
                <label for="status">Statut de l'√©v√©nement</label>
                <select
                  id="status"
                  name="status"
                  [(ngModel)]="eventData.status"
                  class="form-input"
                >
                  <option value="planned">Pr√©vu</option>
                  <option value="active">Active</option>
                  <option value="completed">Termin√©</option>
                  <option value="cancelled">Annul√©</option>
                </select>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-primary btn-text" (click)="nextStep()">
                  Suivant ‚Üí
                </button>
              </div>
            </div>

            <!-- Step 2: Event Details -->
            <div *ngIf="currentStep() === 2" class="step-content">
              <h2>D√©tails de l'√©v√©nement</h2>

              <div class="form-group">
                <label for="eventDescription">Message d'invitation</label>
                <textarea
                  id="eventDescription"
                  name="eventDescription"
                  [(ngModel)]="eventData.description"
                  placeholder="Saisisez votre message d‚Äôinvitation formel et chaleureux..."
                  rows="4"
                  class="form-textarea"
                ></textarea>
              </div>

              <div class="form-group">
                <label for="totalGuests">Nombre total d'invit√©s</label>
                <input
                  type="number"
                  id="totalGuests"
                  name="totalGuests"
                  [(ngModel)]="eventData.totalGuests"
                  min="1"
                  placeholder="150"
                  required
                  class="form-input"
                />
              </div>

              <div class="form-group">
                <label for="budget">Budget (optionnel)</label>
                <div class="input-with-icon">
                  <span class="currency">‚Ç¨</span>
                  <input
                    type="number"
                    id="budget"
                    name="budget"
                    [(ngModel)]="eventData.budget"
                    placeholder="0"
                    min="0"
                    class="form-input"
                  />
                </div>
              </div>

              <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="form-group">
                <label *ngIf="showWeddingNames" for="eventNameConcerned2">Prenom du future mari√©</label>
                <label *ngIf="showEngagementNames" for="eventNameConcerned2">Prenom du fianc√©</label>
                <label *ngIf="showAnniversaryNames" for="eventNameConcerned2">Nom du mari√©</label>
                <input
                  type="text"
                  id="eventNameConcerned1"
                  name="eventNameConcerned1"
                  [(ngModel)]="eventData.eventNameConcerned1"
                  required
                  class="form-input"
                />
              </div>

              <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="form-group">
                <label *ngIf="showWeddingNames" for="eventNameConcerned2">Prenom de la future mari√©e</label>
                <label *ngIf="showEngagementNames" for="eventNameConcerned2">Prenom de la fianc√©e</label>
                <label *ngIf="showAnniversaryNames" for="eventNameConcerned2">Nom de la mari√©e</label>
                <input
                  type="text"
                  id="eventNameConcerned2"
                  name="eventNameConcerned2"
                  [(ngModel)]="eventData.eventNameConcerned2"
                  required
                  class="form-input"
                />
              </div>

              <div *ngIf="showBirthdayNames || showAnother" class="form-group">
                <label for="eventNameConcerned1">Nom du concern√©</label>
                <input
                  type="text"
                  id="eventNameConcerned1"
                  name="eventNameConcerned1"
                  [(ngModel)]="eventData.eventNameConcerned1"
                  required
                  class="form-input"
                />
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="eventData.allowDietaryRestrictions" name="allowDietaryRestrictions" />
                  <span>Permettre les restrictions alimentaires</span>
                </label>
              </div>

              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="eventData.allowPlusOne" name="allowPlusOne" />
                  <span>Permettre les +1</span>
                </label>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="previousStep()">
                  ‚Üê Pr√©c√©dent
                </button>
                <button type="button" class="btn btn-primary btn-text" (click)="nextStep()">
                  Suivant ‚Üí
                </button>
              </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div *ngIf="currentStep() === 3" class="step-content">
              <h2>Confirmation des modifications</h2>

              <div class="confirmation-card">
                <h3>R√©sum√© de votre √©v√©nement</h3>

                <div class="confirmation-item">
                  <span class="label">Titre :</span>
                  <span class="value">{{ eventData.title }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Date :</span>
                  <span class="value">{{ formatDate(eventData.date) }} √† {{ eventData.time }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Lieu :</span>
                  <span class="value">{{ eventData.location }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Nombre d'invit√©s :</span>
                  <span class="value">{{ eventData.totalGuests }}</span>
                </div>

                <div class="confirmation-item" *ngIf="eventData.budget">
                  <span class="label">Budget :</span>
                  <span class="value">{{ eventData.budget }}‚Ç¨</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Type :</span>
                  <span class="value">{{ getEventTypeLabel(eventData.type) }}</span>
                </div>

                <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="confirmation-item">
                  <span *ngIf="showWeddingNames" class="label">Prenom du future mari√© :</span>
                  <span *ngIf="showEngagementNames" class="label">Prenom du fianc√© :</span>
                  <span *ngIf="showAnniversaryNames" class="label">Nom du mari√© :</span>
                  <span class="value">{{ eventData.eventNameConcerned1 }}</span>
                </div>

                <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="confirmation-item">
                  <span *ngIf="showWeddingNames" class="label">Prenom de la future mari√©e :</span>
                  <span *ngIf="showEngagementNames" class="label">Prenom de la fianc√©e :</span>
                  <span *ngIf="showAnniversaryNames" class="label">Nom de la mari√©e :</span>
                  <span class="value">{{ eventData.eventNameConcerned2 }}</span>
                </div>

                <div *ngIf="showBirthdayNames || showAnother" class="confirmation-item">
                  <span class="label">Nom du concern√© :</span>
                  <span class="value">{{ eventData.eventNameConcerned1 }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Statut :</span>
                  <span class="value status" [class]="'status-' + eventData.status">
                    {{ getStatusLabel(eventData.status) }}
                  </span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Restrictions alimentaires :</span>
                  <span class="value">{{ eventData.allowDietaryRestrictions ? 'Activ√©es' : 'D√©sactiv√©es' }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">+1 autoris√©s :</span>
                  <span class="value">{{ eventData.allowPlusOne ? 'Oui' : 'Non' }}</span>
                </div>
              </div>

              <!-- Changes Summary -->
              <div class="changes-summary" *ngIf="getChanges().length > 0">
                <h3>Modifications d√©tect√©es</h3>
                <ul class="changes-list">
                  <li *ngFor="let change of getChanges()">
                    <span class="change-field">{{ change.field }}</span>
                    <span class="change-arrow">‚Üí</span>
                    <span class="change-value">{{ change.newValue }}</span>
                  </li>
                </ul>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="previousStep()">
                  ‚Üê Pr√©c√©dent
                </button>
                <button type="submit" class="btn btn-primary btn-text-center" [disabled]="!eventForm.valid">
                  ‚úì Enregistrer les modifications
                </button>
              </div>
            </div>
          </form>

          <!-- Delete Button -->
          <div class="delete-section">
            <button type="button" class="btn btn-outline btn-danger" (click)="openDeleteModal('delete')">
              üóëÔ∏è Supprimer cet √©v√©nement
            </button>
          </div>
        </div>
      </div>
    </div>

    <app-error-modal
        [visible]="showErrorModal"
        [message]="errorMessage"
        (closed)="closeErrorModal()">
    </app-error-modal>

    <!-- Modal de confirmation -->
    <app-confirm-delete-modal
        [visible]="showDeleteModal"
        [message] = warningMessage
        [action]="modalAction"
        (confirmDelete)="confirmDelete()"
        (cancel)="closeModal()">
    </app-confirm-delete-modal>