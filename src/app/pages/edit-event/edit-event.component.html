    <div class="edit-event">

    <!-- Indicateur de chargement -->
    <app-spinner [isLoading]="isLoading"></app-spinner>

      <!-- Header -->
      <div class="edit-event-header">
        <div class="container c-container">
          <a (click)="navigaToEvents()" class="back-link">‚Üê Retour</a>
          <h1>Modifier l'√©v√©nement</h1>
          <p>Mettez √† jour les d√©tails de votre √©v√©nement</p>
        </div>
      </div>

      <!-- Main content -->
      <div class="container py-12">
        <div class="form-wrapper" [class.wide-wrapper]="currentStep() === 3">
          <form (ngSubmit)="onSubmit()" #eventForm="ngForm" class="event-form">
            <!-- Step indicator -->
            <div class="step-indicator">
              <div
                class="step"
                (click)="changeStep(eventForm, 1)"
                [class.active]="currentStep() === 1"
                [class.completed]="currentStep() > 1"
              >
                <span>1</span>
                <p>Informations</p>
              </div>

              <div class="step-line" [class.completed]="currentStep() > 1"></div>

              <div
                class="step"
                (click)="changeStep(eventForm, 2)"
                [class.active]="currentStep() === 2"
                [class.completed]="currentStep() > 2"
              >
                <span>2</span>
                <p>D√©tails</p>
              </div>

              <div class="step-line" [class.completed]="currentStep() > 2"></div>

              <div
                class="step"
                (click)="changeStep(eventForm, 3)"
                [class.active]="currentStep() === 3"
                [class.completed]="currentStep() > 3"
              >
                <span>3</span>
                <p>Personnalisation</p>
              </div>

              <div class="step-line" [class.completed]="currentStep() > 3"></div>

              <div
                class="step"
                (click)="changeStep(eventForm, 4)"
                [class.active]="currentStep() === 4"
              >
                <span>4</span>
                <p>Confirmation</p>
              </div>
            </div>

            <!-- Step 1: Basic Information -->
            <div *ngIf="currentStep() === 1" class="step-content">
              <h2>Informations de base</h2>

              <div class="form-group">
                <label for="eventTitle">Titre de l'√©v√©nement</label>
                <input
                  type="text"
                  id="eventTitle"
                  name="eventTitle"
                  [(ngModel)]="eventData.title"
                  placeholder="Ex: Mariage de Sophie et Pierre"
                  required
                  #eventTitle="ngModel"
                  class="form-input"
                />
                <div class="error" *ngIf="eventTitle.invalid && eventTitle.touched">
                  Le titre de l'√©v√©nement est obligatoire
                </div>
                <p class="form-hint">Donnez un titre √† votre √©v√©nement</p>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="eventType">Type d'√©v√©nement</label>
                  <select
                    id="eventType"
                    name="eventType"
                    [(ngModel)]="eventData.type"
                    (change)="showSelection()"
                    required
                    #eventType="ngModel"
                    class="form-input"
                  >
                    <option value="">S√©lectionner un type</option>
                    <option value="wedding">Mariage</option>
                    <option value="engagement">Fian√ßailles</option>
                    <option value="anniversary">Anniversaire de Mariage</option>
                    <option value="birthday">Anniversaire</option>
                    <option value="other">Autre</option>
                  </select>
                  <div class="error" *ngIf="eventType.invalid && eventType.touched">
                    Le type de l'√©v√©nement est obligatoire
                  </div>
                </div>
                <div class="form-group">
                  <label for="eventDate">Date de l'√©v√©nement</label>
                  <input
                    type="date"
                    id="eventDate"
                    name="eventDate"
                    [(ngModel)]="eventData.date"
                    required
                    #eventDate="ngModel"
                    class="form-input"
                  />
                  <div class="error" *ngIf="eventDate.invalid && eventDate.touched">
                    La date de l'√©v√©nement est obligatoire
                  </div>
                </div>
              </div>

              <!-- Checkbox -->
              <div class="form-group checkbox-group checkbox-text">
                <label class="custom-checkbox">
                  <input
                    type="checkbox"
                    [(ngModel)]="invitationData.hasInvitationModelCard"
                    name="hasInvitationModelCard"
                    (change)="toggleInvitationModelCard()"
                  />
                  <span class="checkmark"></span>
                  <span class="label-text">
                    Je vais importer mon mod√®le de carte d'invitation
                  </span>
                </label>
              </div>

              <div *ngIf="!invitationData.hasInvitationModelCard">
                <div class="form-row conditional-fields">
                  <div *ngIf="showWeddingCivilLocation" class="form-group">
                    <label for="eventCivilLocation">Lieu de c√©l√©bration du mariage civil</label>
                      <input
                        type="text"
                        id="eventCivilLocation"
                        name="eventCivilLocation"
                        [(ngModel)]="eventData.civilLocation"
                        placeholder="Ex: H√¥tel de ville de Bafoussam"
                        [required]="!hasInvitationModelCard"
                      #eventCivilLocation="ngModel"
                      class="form-input"
                    />
                    <div class="error" *ngIf="eventCivilLocation.invalid && eventCivilLocation.touched">
                      Localisation obligatoire
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="eventTime">Heure de l'√©v√©nement</label>
                    <input
                      type="time"
                      id="eventTime"
                      name="eventTime"
                      [(ngModel)]="eventData.time"
                      [required]="!hasInvitationModelCard"
                      #eventTime="ngModel"
                      class="form-input"
                    />
                    <div class="error" *ngIf="eventTime.invalid && eventTime.touched">
                      Heure obligatoire
                    </div>
                  </div>
                  <div *ngIf="!showWeddingCivilLocation" class="form-group">
                    <!-- <label *ngIf="showWeddingCivilLocation" for="eventLocation">Lieu du Banquet de Mariage</label> -->
                    <label for="eventLocation">Lieu de l'√©v√©nement</label>
                    <input
                      type="text"
                      id="eventLocation"
                      name="eventLocation"
                      [(ngModel)]="eventData.location"
                      placeholder="Ex: Palais de F√™te, Bafoussam"
                      [required]="!hasInvitationModelCard"
                      #eventLocation="ngModel"
                      class="form-input"
                    />
                    <div class="error" *ngIf="eventLocation.invalid && eventLocation.touched">
                      Localisation obligatoire
                    </div>
                  </div>
                </div>

                <!-- Checkbox -->
                <div *ngIf="showWeddingCivilLocation" class="form-group checkbox-group checkbox-text">
                  <label class="custom-checkbox">
                    <input
                      type="checkbox"
                      [(ngModel)]="eventData.showWeddingReligiousLocation"
                      name="hasReligiousCeremony"
                      (change)="toggleReligiousCeremony()"
                    />
                    <span class="checkmark"></span>
                    <span class="label-text">
                      C√©r√©monie religieuse
                    </span>
                  </label>
                </div>

                <!-- Formulaire c√©r√©monie religieuse -->
                <div *ngIf="eventData.showWeddingReligiousLocation" class="form-row conditional-fields">
                  <div class="form-group">
                    <label for="eventReligiousLocation">
                      Lieu de la C√©r√©monie Religieuse
                    </label>
                    <input
                      type="text"
                      id="eventReligiousLocation"
                      name="eventReligiousLocation"
                      [(ngModel)]="eventData.religiousLocation"
                      placeholder="Ex: √âglise Saint Pierre de Bafoussam"
                      class="form-input"
                    />
                  </div>
                  <div class="form-group">
                    <label for="eventReligiousTime">Heure de la c√©r√©monie</label>
                    <input
                      type="time"
                      id="eventReligiousTime"
                      name="eventReligiousTime"
                      [(ngModel)]="eventData.religiousTime"
                      class="form-input"
                    />
                  </div>
                </div>
              </div>

              <div class="form-row conditional-fields">
                <div class="form-group" *ngIf="showWeddingCivilLocation">
                  <label  for="eventLocation">Lieu du Banquet de Mariage *</label>
                  <input
                    type="text"
                    id="eventLocation"
                    name="eventLocation"
                    [(ngModel)]="eventData.location"
                    placeholder="Ex: Palais de F√™te, Bafoussam"
                    required
                    #eventLocation="ngModel"
                    class="form-input"
                  />
                  <div class="error" *ngIf="eventLocation.invalid && eventLocation.touched">
                      Localisation obligatoire
                  </div>
                </div>
                <div *ngIf="showWeddingCivilLocation" class="form-group">
                  <label for="eventBanquetTime">Heure du Banquet *</label>
                  <input
                    type="time"
                    id="eventBanquetTime"
                    name="eventBanquetTime"
                    [(ngModel)]="eventData.banquetTime"
                    required
                    #eventBanquetTime="ngModel"
                    class="form-input"
                  />
                  <div class="error" *ngIf="eventBanquetTime.invalid && eventBanquetTime.touched">
                      Heure obligatoire
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-primary btn-text" (click)="nextStep(eventForm)">
                  Suivant ‚Üí
                </button>
              </div>
            </div>

            <!-- Step 2: Event Details -->
            <div *ngIf="currentStep() === 2" class="step-content">
              <h2>D√©tails de l'√©v√©nement</h2>

              <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="form-row">
                <div class="form-group">
                  <label *ngIf="showWeddingNames">Pr√©nom du futur mari√©</label>
                  <label *ngIf="showEngagementNames">Pr√©nom du fianc√©</label>
                  <label *ngIf="showAnniversaryNames">Nom du mari√©</label>
                  <input type="text" name="name1" [(ngModel)]="eventData.eventNameConcerned1" 
                    required
                    #eventNameConcerned1="ngModel"
                    class="form-input" />
                  <div class="error" *ngIf="eventNameConcerned1.invalid && eventNameConcerned1.touched">
                      Champ obligatoire
                  </div>
                </div>
                <div class="form-group">
                  <label *ngIf="showWeddingNames">Pr√©nom de la future mari√©e</label>
                  <label *ngIf="showEngagementNames">Pr√©nom de la fianc√©e</label>
                  <label *ngIf="showAnniversaryNames">Nom de la mari√©e</label>
                  <input type="text" name="name2" [(ngModel)]="eventData.eventNameConcerned2" 
                    required
                    #eventNameConcerned2="ngModel" />
                  <div class="error" *ngIf="eventNameConcerned2.invalid && eventNameConcerned2.touched">
                      Champ obligatoire
                  </div>
                </div>
              </div>

              <div *ngIf="showBirthdayNames || showAnother" class="form-group">
                <label>Nom de la personne concern√©e</label>
                <input type="text" name="name1" [(ngModel)]="eventData.eventNameConcerned1" 
                  required
                  #eventNameConcerned1="ngModel" 
                />
                <div class="error" *ngIf="eventNameConcerned1.invalid && eventNameConcerned1.touched">
                    Champ obligatoire
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="totalGuests">Nombre d'invit√©s max</label>
                  <input type="number" id="totalGuests" name="totalGuests" [(ngModel)]="eventData.totalGuests"
                    min="1"
                    required
                    #totalGuests="ngModel"
                    class="form-input" />
                  <div class="error" *ngIf="totalGuests.invalid && totalGuests.touched">
                    Le nombre d‚Äôinvit√©s doit √™tre ‚â• 1
                  </div>
                </div>
                <div class="form-group">
                  <label for="budget">Budget estim√© (‚Ç¨)</label>
                  <input type="number" id="budget" name="budget" [(ngModel)]="eventData.budget" class="form-input" />
                </div>
              </div>

              <div class="form-group checkbox-group checkbox-text">
                <label class="custom-checkbox">
                  <input type="checkbox" name="allowPlusOne" [(ngModel)]="eventData.allowPlusOne" />
                  <span class="checkmark"></span>
                  <span class="label-text">
                    Autoriser les "+1"
                  </span>
                </label>
              </div>

              <div class="form-group checkbox-group checkbox-text">
                <label class="custom-checkbox">
                  <input type="checkbox" name="allowDietaryRestrictions" [(ngModel)]="eventData.allowDietaryRestrictions" />
                  <span class="checkmark"></span>
                  <span class="label-text">
                    G√©rer les restrictions alimentaires
                  </span>
                </label>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="previousStep()">‚Üê Pr√©c√©dent</button>
                <button type="button" class="btn btn-primary btn-text" (click)="nextStep(eventForm)">Suivant ‚Üí</button>
              </div>
            </div>

            <!-- Step 3: Invitation Editor -->
            <div *ngIf="currentStep() === 3" class="step-content invitation-editor-step">
              <h2 class="txt-title">Personnalisation de l'invitation</h2>
              <div class="editor-wrapper">
                <!-- Form Section -->
                <div *ngIf="!invitationData.hasInvitationModelCard" class="editor-form">
                  <div class="form-card">
                    <h2 class="txt-title c-size">Param√®tres de l'invitation</h2>

                    <!-- Section 1: D√©tails de l'√©v√©nement -->
                    <div class="form-section">
                      <!-- <h3>üìÖ D√©tails de l'√©v√©nement</h3> -->

                      <div class="form-group">
                        <label>Nom de l'√©v√©nement *</label>
                        <input
                          type="text"
                          name="eventName"
                          [(ngModel)]="eventData.title"
                          placeholder="Ex: Mariage de Sophie et Pierre"
                          class="form-input"
                        />
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label>Date *</label>
                          <input
                            type="date"
                            name="eventDate"
                            [(ngModel)]="eventData.date"
                            class="form-input"
                          />
                        </div>

                        <div class="form-group">
                          <label>Heure *</label>
                          <input
                            type="time"
                            name="eventTime"
                            [(ngModel)]="eventData.time"
                            class="form-input"
                          />
                        </div>
                      </div>

                      <div class="form-group">
                        <label>Lieu de la c√©r√©monie civile *</label>
                        <input
                          type="text"
                          name="eventCivilLocation"
                          [(ngModel)]="eventData.civilLocation"
                          placeholder="Ex: Mairie de Bangangte"
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Lieu de la r√©ception *</label>
                        <input
                          type="text"
                          name="eventLocation"
                          [(ngModel)]="eventData.location"
                          placeholder="Ex: Palais de F√™te, Bafoussam"
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Heure de la r√©ception *</label>
                        <input
                          type="time"
                          name="banquetTime"
                          [(ngModel)]="eventData.banquetTime"
                          class="form-input"
                        />
                      </div>

                      <!-- C√©r√©monie religieuse (optionnelle) -->
                       <div class="form-group checkbox-group checkbox-text">
                        <label class="custom-checkbox">
                          <input
                            type="checkbox"
                            name="showReligiousCeremony"
                            [(ngModel)]="eventData.showWeddingReligiousLocation"
                          />
                          <span class="checkmark"></span>
                          <span class="label-text">
                            Afficher la c√©r√©monie religieuse
                          </span>
                        </label>
                      </div>

                      <div *ngIf="eventData.showWeddingReligiousLocation" class="conditional-fields">
                        <div class="form-group">
                          <label>Lieu de la c√©r√©monie religieuse</label>
                          <input
                            type="text"
                            name="religiousLocation"
                            [(ngModel)]="eventData.religiousLocation"
                            placeholder="Ex: Cath√©drale Notre-Dame"
                            class="form-input"
                          />
                        </div>

                        <div class="form-group">
                          <label>Heure de la c√©r√©monie religieuse</label>
                          <input
                            type="time"
                            name="religiousTime"
                            [(ngModel)]="eventData.religiousTime"
                            class="form-input"
                          />
                        </div>
                      </div>
                    </div>

                    <!-- Section 2: Personnes concern√©es -->
                    <div class="form-section">
                      <h3>üë• Personnes concern√©es</h3>

                      <div class="form-row">
                        <div class="form-group">
                          <label>Premi√®re personne *</label>
                          <input
                            type="text"
                            name="nameConcerned1"
                            [(ngModel)]="eventData.eventNameConcerned1"
                            placeholder="Ex: Sophie"
                            class="form-input"
                          />
                        </div>

                        <div class="form-group">
                          <label>Deuxi√®me personne *</label>
                          <input
                            type="text"
                            name="nameConcerned2"
                            [(ngModel)]="eventData.eventNameConcerned2"
                            placeholder="Ex: Pierre"
                            class="form-input"
                          />
                        </div>
                      </div>
                    </div>

                    <!-- Section 3: Contenu principal -->
                    <div class="form-section">
                      <h3>‚úçÔ∏è Contenu principal</h3>
                      <div class="form-group">
                        <label>Titre</label>
                        <input
                          type="text"
                          name="invtile"
                          [(ngModel)]="invitationData.title"
                          placeholder="Ex: L'ETTRE D'INVITATION"
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Message principal</label>
                        <textarea
                          name="mainMessage"
                          [(ngModel)]="invitationData.mainMessage"
                          class="form-textarea"
                          placeholder="C'est avec un immense bonheur que nous vous invitons..."
                        ></textarea>
                      </div>

                      <div class="form-group">
                        <label>Sous Message</label>
                        <textarea
                          name="sousMainMessage"
                          [(ngModel)]="invitationData.sousMainMessage"
                          class="form-textarea"
                          placeholder="Mini r√©ception √† la sortie de la mairie..."
                        ></textarea>

                      <div class="form-group">
                        <label>Th√®me de la soir√©e</label>
                        <input
                          type="text"
                          name="eventTheme"
                          [(ngModel)]="invitationData.eventTheme"
                          placeholder="Ex: CHIC ET GLAMOUR"
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Couleurs prioris√©es</label>
                        <input
                          type="text"
                          name="priorityColors"
                          [(ngModel)]="invitationData.priorityColors"
                          placeholder="Ex: Bleu, Blanc, Rouge, Noir"
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Instructions QR Code</label>
                        <textarea
                          name="qrInstructions"
                          [(ngModel)]="invitationData.qrInstructions"
                          class="form-textarea"
                          placeholder="Pri√®re de vous pr√©senter uniquement avec votre code QR..."
                        ></textarea>
                      </div>

                      <div class="form-group">
                        <label>Message sur le code vestimentaire</label>
                        <input
                          type="text"
                          name="dressCodeMessage"
                          [(ngModel)]="invitationData.dressCodeMessage"
                          placeholder="Ex: Merci de respecter les couleurs vestimentaires choisies."
                          class="form-input"
                        />
                      </div>

                      <div class="form-group">
                        <label>Premier message de remerciement</label>
                        <input
                          type="text"
                          name="thanksMessage1"
                          [(ngModel)]="invitationData.thanksMessage1"
                          placeholder="Ex: Merci pour votre compr√©hension."
                          class="form-input"
                        />
                      </div>

                      </div>

                      <div class="form-group">
                        <label>Message de fermeture</label>
                        <input
                          type="text"
                          name="closingMessage"
                          [(ngModel)]="invitationData.closingMessage"
                          placeholder="Ex: Votre pr√©sence illuminera ce jour si sp√©cial pour nous."
                          class="form-input"
                        />
                      </div>
                    </div>

                    <!-- Section 4: Couleurs et design -->
                    <div class="form-section">
                      <h3>üé® Couleurs et design</h3>

                      <div class="form-row">
                        <div class="form-group">
                          <label>Couleur du titre</label>
                          <div class="color-input-group">
                            <input
                              type="color"
                              name="titleColor"
                              [(ngModel)]="invitationData.titleColor"
                              class="color-input"
                            />
                            <input
                              type="text"
                              name="titleColor"
                              [(ngModel)]="invitationData.titleColor"
                              class="form-input"
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label>Couleur du texte</label>
                          <div class="color-input-group">
                            <input
                              type="color"
                              name="textColor"
                              [(ngModel)]="invitationData.textColor"
                              class="color-input"
                            />
                            <input
                              type="text"
                              name="textColor"
                              [(ngModel)]="invitationData.textColor"
                              class="form-input"
                            />
                          </div>
                        </div>
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label>Couleur de la bande sup√©rieure</label>
                          <div class="color-input-group">
                            <input
                              type="color"
                              name="topBandColor"
                              [(ngModel)]="invitationData.topBandColor"
                              class="color-input"
                            />
                            <input
                              type="text"
                              name="topBandColor"
                              [(ngModel)]="invitationData.topBandColor"
                              class="form-input"
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label>Couleur de la bande inf√©rieure</label>
                          <div class="color-input-group">
                            <input
                              type="color"
                              name="bottomBandColor"
                              [(ngModel)]="invitationData.bottomBandColor"
                              class="color-input"
                            />
                            <input
                              type="text"
                              name="bottomBandColor"
                              [(ngModel)]="invitationData.bottomBandColor"
                              class="form-input"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Form Section -->
                <div *ngIf="invitationData.hasInvitationModelCard" class="editor-form">
                  <div class="form-card">
                    <h2 class="txt-title c-size">Param√®tres de l'invitation</h2>

                    <!-- Section 5: file pdf -->
                    <div class="form-actions">
                        <!-- Input cach√© pour l'import -->
                        <input
                          type="file"
                          #fileInput
                          (change)="onFileSelected($event)"
                          accept="application/pdf"
                          style="display: none"
                        />
                        
                        <!-- Bouton d'importation -->
                        <button type="button" class="btn btn-primary c_j_txt" (click)="fileInput.click()">
                          üì• Modifier le model PDF
                        </button>
                      <!-- <button class="btn btn-outline" (click)="resetForm()">
                        ‚Ü∫ R√©initialiser
                      </button> -->
                    </div>
                  </div>
                </div>

                <!-- Preview Section -->
                <div class="editor-preview">
                  <div class="preview-card">
                    <h2 class="txt-title c-size">Aper√ßu de la carte</h2>

                    <!-- Affichage du PDF import√© s'il existe -->
                     <!-- <div *ngIf="invitationData.hasInvitationModelCard && invitationData.pdfUrl">
                        <div *ngIf="!newFile" class="pdf-preview-container">
                          <div class="pdf-header">
                            <span>Mod√®le PDF import√©</span>
                            <a
                              *ngIf="invitationData.pdfUrl"
                              [href]="invitationData.pdfUrl"
                              target="_blank"
                              class="btn btn-outline c_btn"
                              >
                                üìÑ Ouvrir le PDF
                            </a>
                          </div>
                          <div class="pdf-body">
                            <iframe [src]="invitationData.pdfUrl | safe" width="100%" height="500px"></iframe>
                          </div>
                        </div>
                        <div *ngIf="newFile" class="pdf-preview-container">
                          <div class="pdf-header">
                            <span>Mod√®le PDF import√©</span>
                            <button type="button" class="btn-remove" (click)="removePdfModel()">‚úï</button>
                          </div>
                          <div class="pdf-body">
                            <iframe [src]="pdfModelUrl | safe" width="100%" height="500px"></iframe>
                          </div>
                        </div>
                     </div> -->
                    <div *ngIf="invitationData.hasInvitationModelCard" class="pdf-preview-container">
                      <div class="pdf-header">
                        <span>Mod√®le de carte d'invitation</span>
                        <a
                          *ngIf="!newFile && invitationData.pdfUrl"
                          [href]="invitationData.pdfUrl"
                          target="_blank"
                          class="btn btn-outline c_btn"
                        >
                          üìÑ Ouvrir le PDF
                        </a>
                        <button
                          *ngIf="newFile" type="button"
                          class="btn-remove" (click)="removePdfModel()"
                        >
                          ‚úï
                        </button>
                      </div>

                      <div class="pdf-body">
                        <iframe
                          [src]="currentPdfUrl | safe"
                          width="100%"
                          height="500px"
                        ></iframe>
                      </div>
                    </div>
                  
                    <div *ngIf="!invitationData.hasInvitationModelCard" class="preview-container">
                      <!-- Top band -->
                      <div class="preview-top-band" [style.background-color]="invitationData.topBandColor"></div>

                      <!-- Content -->
                      <div class="preview-content">
                        <!-- Logo -->
                        <div class="preview-logo" *ngIf="invitationData.logoUrl">
                          <img [src]="invitationData.logoUrl" alt="Logo" />
                        </div>

                        <!-- Title -->
                        <h1 class="preview-title" [style.color]="invitationData.titleColor">
                          {{ invitationData.title }}
                        </h1>

                        <!-- Guest greeting -->
                        <p class="preview-greeting">
                          Cher/Ch√®re invit√©,
                        </p>

                        <!-- Main message -->
                        <p class="preview-message">{{ invitationData.mainMessage }}</p>

                        <!-- Event details -->
                        <div class="preview-event-details">
                          <h3>PROGRAMME DE LA JOURN√âE</h3>
                          <p>
                            <strong>MARIAGE CIVIL LE {{ formatDate(eventData.date) }} A {{ eventData.time }}</strong><br />
                            {{ eventData.civilLocation }}<br />
                            {{ invitationData.sousMainMessage }} 
                          </p>

                          <p *ngIf="eventData.showWeddingReligiousLocation">
                            <strong>C√©r√©monie Religieuse {{ eventData.religiousTime }}</strong><br />
                            {{ eventData.religiousLocation }}
                          </p>

                          <p>
                            <strong>R√©ception nuptiale le m√™me jour √† partir de {{ eventData.banquetTime }}</strong><br />
                            {{ eventData.location }}
                          </p>
                        </div>

                        <!-- Theme -->
                        <h3 class="preview-theme">THEME DE LA SOIR√âE : {{ invitationData.eventTheme }}</h3>

                        <p class="preview-colors-label">Couleurs prioris√©es</p>
                        <p class="preview-colors">{{ invitationData.priorityColors }}</p>

                        <!-- QR Instructions -->
                        <p class="preview-qr-text">{{ invitationData.qrInstructions }}</p>

                        <!-- Thanks messages -->
                        <p class="preview-thanks">{{ invitationData.dressCodeMessage }}</p>
                        <p class="preview-thanks">{{ invitationData.thanksMessage1 }}</p>

                        <!-- Closing message -->
                        <p class="preview-closing">{{ invitationData.closingMessage }}</p>

                        <!-- Signature -->
                        <p class="preview-signature" [style.color]="invitationData.titleColor">
                          {{ eventData.eventNameConcerned1 }} & {{ eventData.eventNameConcerned2 }}
                        </p>

                        <!-- Heart icon -->
                        <div class="preview-heart" *ngIf="invitationData.heartIconUrl">
                          <img [src]="invitationData.heartIconUrl" alt="Heart" />
                        </div>
                      </div>

                      <!-- Bottom band -->
                      <div class="preview-bottom-band" [style.background-color]="invitationData.bottomBandColor"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="previousStep()">‚Üê Pr√©c√©dent</button>
                <button type="button" class="btn btn-primary" (click)="nextStep(eventForm)">Suivant ‚Üí</button>
              </div>
            </div>

            <!-- Step 4: Confirmation -->
            <div *ngIf="currentStep() === 4" class="step-content">
              <h2>Confirmation des modifications</h2>

              <div class="confirmation-card">
                <h3>R√©sum√© de votre √©v√©nement</h3>

                <div class="confirmation-item">
                  <span class="label">Titre :</span>
                  <span class="value">{{ eventData.title }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Date :</span>

                  <span *ngIf="eventData.time; else dateOnly" class="value">
                    {{ formatDate(eventData.date) }} √† {{ eventData.time }}
                  </span>

                  <ng-template #dateOnly>
                    <span class="value">
                      {{ formatDate(eventData.date) }}
                    </span>
                  </ng-template>
                </div>

                <div class="confirmation-item">
                  <span class="label">Lieu :</span>
                  <span class="value">{{ eventData.location }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Nombre d'invit√©s :</span>
                  <span class="value">{{ eventData.totalGuests }}</span>
                </div>

                <div class="confirmation-item" *ngIf="eventData.budget">
                  <span class="label">Budget :</span>
                  <span class="value">{{ eventData.budget }}‚Ç¨</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Type :</span>
                  <span class="value">{{ getEventTypeLabel(eventData.type) }}</span>
                </div>

                <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="confirmation-item">
                  <span *ngIf="showWeddingNames" class="label">Prenom du future mari√© :</span>
                  <span *ngIf="showEngagementNames" class="label">Prenom du fianc√© :</span>
                  <span *ngIf="showAnniversaryNames" class="label">Nom du mari√© :</span>
                  <span class="value">{{ eventData.eventNameConcerned1 }}</span>
                </div>

                <div *ngIf="showWeddingNames || showEngagementNames || showAnniversaryNames" class="confirmation-item">
                  <span *ngIf="showWeddingNames" class="label">Prenom de la future mari√©e :</span>
                  <span *ngIf="showEngagementNames" class="label">Prenom de la fianc√©e :</span>
                  <span *ngIf="showAnniversaryNames" class="label">Nom de la mari√©e :</span>
                  <span class="value">{{ eventData.eventNameConcerned2 }}</span>
                </div>

                <div *ngIf="showBirthdayNames || showAnother" class="confirmation-item">
                  <span class="label">Nom du concern√© :</span>
                  <span class="value">{{ eventData.eventNameConcerned1 }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Statut :</span>
                  <span class="value status" [class]="'status-' + eventData.status">
                    {{ getStatusLabel(eventData.status) }}
                  </span>
                </div>

                <div class="confirmation-item">
                  <span class="label">Restrictions alimentaires :</span>
                  <span class="value">{{ eventData.allowDietaryRestrictions ? 'Activ√©es' : 'D√©sactiv√©es' }}</span>
                </div>

                <div class="confirmation-item">
                  <span class="label">+1 autoris√©s :</span>
                  <span class="value">{{ eventData.allowPlusOne ? 'Oui' : 'Non' }}</span>
                </div>
              </div>

              <!-- Changes Summary -->
              <div class="changes-summary" *ngIf="getChanges().length > 0">
                <h3>Modifications d√©tect√©es</h3>
                <ul class="changes-list">
                  <li *ngFor="let change of getChanges()">
                    <span class="change-field">{{ change.field }}</span>
                    <span class="change-arrow">‚Üí</span>
                    <span class="change-value">{{ change.newValue }}</span>
                  </li>
                </ul>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline" (click)="previousStep()">
                  ‚Üê Pr√©c√©dent
                </button>
                <button type="submit" class="btn btn-primary btn-text-center" [disabled]="!eventForm.valid">
                  ‚úì Enregistrer les modifications
                </button>
              </div>
            </div>
          </form>

          <!-- Delete Button -->
          <div class="delete-section">
            <button type="button" class="btn btn-outline btn-danger" (click)="openDeleteModal('delete')">
              üóëÔ∏è Supprimer cet √©v√©nement
            </button>
          </div>
        </div>
      </div>
    </div>

    <app-error-modal
        [visible]="showErrorModal"
        [message]="errorMessage"
        (closed)="closeErrorModal()">
    </app-error-modal>

    <!-- Modal de confirmation -->
    <app-confirm-delete-modal
        [visible]="showDeleteModal"
        [message] = warningMessage
        [action]="modalAction"
        (confirmDelete)="confirmDelete()"
        (cancel)="closeModal()">
    </app-confirm-delete-modal>