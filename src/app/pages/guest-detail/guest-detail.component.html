<div class="guest-detail">
    <!-- Indicateur de chargement -->
    <app-spinner [isLoading]="isLoading"></app-spinner>
    
    <!-- Header -->
    <div class="guest-detail-header">
    <div class="container">
        <a (click)="backToGuestList()" class="back-link">‚Üê Retour √† la liste des invit√©s</a>
        <div class="header-content">
        <div class="guest-avatar-large">
            {{ guest.name.charAt(0).toUpperCase() }}
        </div>
        <div class="guest-header-info">
            <h1>{{ guest.name }}</h1>
            <p class="email">{{ guest.email }}</p>
            <span class="status-badge large" [class]="'status-' + guest.status">
            {{ getStatusIcon(guest.status) }} {{ getStatusLabel(guest.status) }}
            </span>
        </div>
        <div class="header-actions">
            <button class="btn btn-outline" (click)="editGuest()">‚úèÔ∏è √âditer</button>
            <button class="btn btn-outline btn-danger" (click)="openDeleteModal('delete')">üóëÔ∏è Supprimer</button>
        </div>
        </div>
    </div>
    </div>

    <!-- Main content -->
    <div class="container py-12">
        <div class="grid grid-detail">
            <!-- Left column - Guest Information -->
            <div class="left-column">
            <!-- Personal Information -->
            <div class="card">
                <h2>Informations personnelles</h2>

                <div class="info-section">
                <div class="info-row">
                    <span class="label">üìß Email</span>
                    <span class="value">{{ guest.email }}</span>
                </div>

                <div class="info-row" *ngIf="guest.phone">
                    <span class="label">üì± T√©l√©phone</span>
                    <span class="value">{{ guest.phone }}</span>
                </div>

                <div class="info-row" *ngIf="guest.invitationSentDate">
                    <span class="label">üì¨ Invitation envoy√©e</span>
                    <span class="value">{{ formatDate(guest.invitationSentDate) }}</span>
                </div>
                </div>

                <div class="divider-gold"></div>

<<<<<<< HEAD
            <button class="btn btn-outline" style="width: 100%;" (click)="editGuest()">
            ‚úèÔ∏è Modifier les options
            </button>
        </div>

        <!-- Notes -->
        <div class="card mt-8">
            <h2>Notes</h2>

            <div class="notes-box">
            <p *ngIf="guest.notes">{{ guest.notes }}</p>
            <p *ngIf="!guest.notes" class="no-notes">Aucune note</p>
            </div>

            <button class="btn btn-outline" style="width: 100%;" (click)="addNotes()">
            üìù Ajouter une note
            </button>
        </div>
        </div>

        <!-- Right column - QR Code & Actions -->
        <div class="right-column">
        <!-- QR Code Section -->
        <div class="card">
            <h2>Code QR</h2>

            <div *ngIf="guest.qrCodeGenerated" class="qr-code-section">
            <div class="qr-code-container">
                <img
                [src]="guest.qrCodeUrl"
                alt="QR Code"
                class="qr-code-image"
                />
            </div>
            <!-- <p class="qr-description">
                Scannez ce code pour acc√©der √† l'invitation
            </p> -->

            <div class="qr-actions">
                <button class="btn btn-outline" style="width: 100%;" (click)="downloadQRCode()">
                üì• T√©l√©charger
=======
                <button class="btn btn-primary" style="width: 100%;" (click)="resendInvitation()">
                    {{ loading ? '‚è≥ Renvoie en cours ...' : '‚úâÔ∏è Renvoyer rappel invitation' }}
>>>>>>> develop
                </button>
            </div>

            <!-- Event Response -->
            <div class="card mt-8">
                <h2>R√©ponse √† l'√©v√©nement</h2>

                <div class="status-detail">
                <div class="status-icon" [class]="'status-' + guest.status">
                    {{ getStatusIcon(guest.status) }}
                </div>
                <div class="status-info">
                    <p class="status-title">{{ getStatusLabel(guest.status) }}</p>
                    <p class="status-date" *ngIf="guest.responseDate">
                    R√©pondu le {{ formatDate(guest.responseDate) }} √† {{ guest.responseTime }}
                    </p>
                    <p class="status-date" *ngIf="!guest.responseDate">
                    En attente de r√©ponse
                    </p>
                </div>
                </div>

                <div class="divider-gold"></div>

                <div class="action-buttons">
                <button class="btn btn-outline" (click)="markAsPending()">
                    {{ loading ? '‚è≥ Changement en cours ...' : 'Marquer attente'}}
                </button>
                <button class="btn btn-outline" (click)="markAsConfirmed()">
                    {{ loading ? '‚è≥ Changement en cours ...' : '‚úì Marquer confirm√©'}}
                </button>
                <button class="btn btn-outline" (click)="markAsDeclined()">
                    {{ loading ? '‚è≥ Changement en cours ...' : '‚úï Marquer refus√©'}}
                </button>
                </div>
            </div>

            <!-- Dietary Restrictions & Options -->
            <div class="card mt-8">
                <h2>Options et restrictions</h2>

                <div class="options-list">
                    <div class="option-item" *ngIf="guest.dietaryRestrictions">
                        <span class="option-label">üçΩÔ∏è Restrictions alimentaires</span>
                        <span class="option-value">{{ guest.dietaryRestrictions }}</span>
                    </div>

                    <div class="option-item">
                        <span class="option-label">üë• +1 autoris√©</span>
                        <span class="option-value">{{ guest.plusOne ? 'Oui' : 'Non' }}</span>
                    </div>
                </div>

                <div *ngIf="guest.plusOne" class="options-list">
                    <div class="option-item">
                        <span class="option-label">Nom de l'accompagnant</span>
                        <span class="option-value">{{ guest.plusOneName }}</span>
                    </div>

                    <div class="option-item" *ngIf="guest.plusOneDietaryRestrictions">
                        <span class="option-label">üçΩÔ∏è Restrictions alimentaires</span>
                        <span class="option-value">{{ guest.plusOneDietaryRestrictions }}</span>
                    </div>
                </div>

                <div class="divider-gold"></div>

                <button class="btn btn-outline" style="width: 100%;" (click)="editGuest()">
                ‚úèÔ∏è Modifier les options
                </button>
            </div>

            <!-- Notes -->
            <div class="card mt-8">
                <h2>Notes</h2>

                <div class="notes-box">
                <p *ngIf="guest.notes">{{ guest.notes }}</p>
                <p *ngIf="!guest.notes" class="no-notes">Aucune note</p>
                </div>

                <button class="btn btn-outline" style="width: 100%;" (click)="addNotes()">
                üìù Ajouter une note
                </button>
            </div>
            </div>

            <!-- Right column - QR Code & Actions -->
            <div class="right-column">
            <!-- QR Code Section -->
            <div class="card">
                <h2>Code QR</h2>

                <div *ngIf="guest.qrCodeGenerated" class="qr-code-section">
                <div class="qr-code-container">
                    <img
                    [src]="guest.qrCodeUrl"
                    alt="QR Code"
                    class="qr-code-image"
                    />
                </div>
                <p class="qr-description">
                    Scannez ce code pour acc√©der √† l'invitation
                </p>

                <div class="qr-actions">
                    <button class="btn btn-outline" style="width: 100%;" (click)="downloadQRCode()">
                    üì• T√©l√©charger
                    </button>
                    <button class="btn btn-outline" style="width: 100%;" (click)="sendFileQRCode()">
                    {{ loading ? '‚è≥ Envoie en cours ...' :'‚úâÔ∏è Envoyer √† l\'invit√©' }}
                    </button>
                </div>
                </div>

                <div *ngIf="!guest.qrCodeGenerated" class="no-qr-section">
                <div class="no-qr-icon">üì±</div>
                <p>Aucun code QR g√©n√©r√©</p>
                <button class="btn btn-primary" style="width: 100%;" (click)="generateQRCode()">
                    {{loading ? '‚è≥ Envoie en cours ...' :'‚ú® Envoyer une invitation'}}
                </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <!-- <div class="card mt-6">
                <h2>Actions rapides</h2>

                <div class="actions-list">
                <button class="action-btn" (click)="sendMessage()">
                    <span class="icon">üí¨</span>
                    <span class="text">Envoyer un message</span>
                </button>

                <button class="action-btn" (click)="callGuest()">
                    <span class="icon">üìû</span>
                    <span class="text">Appeler</span>
                </button>

                <button class="action-btn" (click)="sendEmail()">
                    <span class="icon">‚úâÔ∏è</span>
                    <span class="text">Envoyer un email</span>
                </button>

                <button class="action-btn" (click)="shareInvitation()">
                    <span class="icon">üîó</span>
                    <span class="text">Partager l'invitation</span>
                </button>
                </div>
            </div> -->

            <!-- Statistics -->
            <!-- <div class="card mt-6">
                <h2>Statistiques</h2>

                <div class="stats-list">
                <div class="stat-item">
                    <span class="stat-label">Statut</span>
                    <span class="stat-value" [class]="'status-' + guest.status">
                    {{ getStatusLabel(guest.status) }}
                    </span>
                </div>

                <div class="stat-item">
                    <span class="stat-label">Invit√© depuis</span>
                    <span class="stat-value">{{ daysAgo(guest.invitationSentDate) }} jours</span>
                </div>

                <div class="stat-item" *ngIf="guest.responseDate">
                    <span class="stat-label">Temps de r√©ponse</span>
                    <span class="stat-value">{{ daysBetween(guest.invitationSentDate, guest.responseDate) }} jours</span>
                </div>
                </div>
            </div> -->
            </div>
        </div>
    </div>
</div>
<!-- <app-footer></app-footer> -->
<!-- Modal de confirmation -->
<app-confirm-delete-modal
    [visible]="showDeleteModal"
    [message] = warningMessage
    [action]="modalAction"
    (confirmDelete)="confirmDelete()"
    (cancel)="closeModal()">
</app-confirm-delete-modal>

<app-error-modal
    [alertMessage]="'alert'"
    [visible]="showErrorModal"
    [message]="errorMessage"
    (closed)="closeErrorModal()">
</app-error-modal>