 <div class="guest-list">
    <!-- Header eventId, eventTitle-->
    <div class="guest-list-header">
    <div class="container">
        <a (click)="navigateToEventPage()" class="back-link">â† Retour a l'Ã©vÃ©nement</a>
        <div class="header-content">
        <div>
            <h1>Gestion des invitÃ©s</h1>
            <p>{{ eventTitle }} - {{ totalGuests }} invitÃ©s</p>
        </div>
        <div class="header-actions">
            <button class="btn btn-primary" (click)="inviteNewGuests()">
            âœ‰ï¸ Inviter de nouveaux invitÃ©s
            </button>
            <button class="btn btn-outline" (click)="exportGuests()">
            ğŸ“¥ Exporter
            </button>
        </div>
        </div>
    </div>
    </div>

    <!-- Main content -->
    <div class="container py-12">
    <!-- Search and Filter -->
    <div class="search-filter-section">
        <div class="search-box">
            <input
                type="text"
                placeholder="Rechercher par nom, email ou tÃ©lÃ©phone..."
                [(ngModel)]="searchTerm"
                (ngModelChange)="filterGuests()"
                class="search-input"
            />
            <span class="search-icon">ğŸ”</span>
        </div>

        <div class="filter-buttons">
            <!-- (click)="setFilterStatus(status)" -->
            <button
                *ngFor="let filter of filters"
                [class.active]="filterStatus() === filter.value"
                (click)="setFilterStatus(filter.value)"
                class="filter-btn"
            >
                {{ getFilterLabel(filter.value) }}
                <span class="count">{{ getStatusCount(filter.value) }}</span>
            </button>
        </div>
    </div>

    <!-- Guests Grid View -->
    <div class="guests-grid">
        <div *ngFor="let guest of filteredGuests" class="guest-card" [class]="'status-' + guest.status">
        <!-- Card Header -->
        <div class="card-header">
            <div class="guest-avatar">
            {{ guest.name.charAt(0).toUpperCase() }}
            </div>
            <div class="guest-status">
            <span class="status-badge" [class]="'status-' + guest.status">
                {{ getStatusIcon(guest.status) }} {{ getStatusLabel(guest.status) }}
            </span>
            </div>
        </div>

        <!-- Card Body -->
        <div class="card-body">
            <h3>{{ guest.name }}</h3>
            <p class="guest-email">{{ guest.email }}</p>

            <div class="guest-info">
            <div class="info-item" *ngIf="guest.phone">
                <span class="label">ğŸ“±</span>
                <span class="value">{{ guest.phone }}</span>
            </div>

            <div class="info-item" *ngIf="guest.dietaryRestrictions">
                <span class="label">ğŸ½ï¸</span>
                <span class="value">{{ guest.dietaryRestrictions }}</span>
            </div>

            <div class="info-item" *ngIf="guest.plusOne">
                <span class="label">ğŸ‘¥</span>
                <span class="value">+1 autorisÃ©</span>
            </div>

            <div class="info-item" *ngIf="guest.responseDate">
                <span class="label">ğŸ“…</span>
                <span class="value">{{ formatDate(guest.responseDate) }}</span>
            </div>
            </div>

            <!-- QR Code Badge -->
            <div class="qr-badge" *ngIf="guest.qrCodeGenerated">
            <span class="qr-icon">ğŸ“±</span>
            <span class="qr-text">QR Code gÃ©nÃ©rÃ©</span>
            </div>
        </div>

        <!-- Card Footer -->
        <div class="card-footer">
            <button
            class="btn-action view"
            (click)="viewGuestDetails(guest)"
            title="Voir les dÃ©tails"
            >
            ğŸ‘ï¸ DÃ©tails
            </button>
            <button
            class="btn-action edit"
            (click)="editGuest(guest)"
            title="Ã‰diter"
            >
            âœï¸ Ã‰diter
            </button>
            <button
            class="btn-action delete"
            (click)="deleteGuest(guest)"
            title="Supprimer"
            >
            ğŸ—‘ï¸ Supprimer
            </button>
        </div>
        </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="filteredGuests.length === 0" class="empty-state">
        <div class="empty-icon">ğŸ‘¥</div>
        <h3>Aucun invitÃ© trouvÃ©</h3>
        <p>Essayez de modifier vos filtres ou invitez de nouveaux invitÃ©s</p>
        <button class="btn btn-primary" (click)="inviteNewGuests()">
        âœ‰ï¸ Inviter des invitÃ©s
        </button>
    </div>

    <!-- Stats Footer -->
    <div class="stats-footer">
        <div class="stat">
        <span class="label">Total</span>
        <span class="value">{{ totalGuests }}</span>
        </div>
        <div class="stat confirmed">
        <span class="label">ConfirmÃ©s</span>
        <span class="value">{{ confirmedCount }}</span>
        </div>
        <div class="stat pending">
        <span class="label">En attente</span>
        <span class="value">{{ pendingCount }}</span>
        </div>
        <div class="stat declined">
        <span class="label">RefusÃ©s</span>
        <span class="value">{{ declinedCount }}</span>
        </div>
    </div>
    </div>

    <!-- Guest Detail Modal -->
    <div *ngIf="selectedGuest() as guest" class="modal-overlay" (click)="closeGuestDetails()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <button class="modal-close" (click)="closeGuestDetails()">âœ•</button>

        <div class="modal-body">
        <!-- Guest Avatar and Name -->
        <div class="modal-header">
            <div class="large-avatar">
            {{ guest.name.charAt(0).toUpperCase() }}
            </div>
            <div>
            <h2>{{ guest.name }}</h2>
            <p class="email">{{ guest.email }}</p>
            </div>
        </div>

        <!-- Status Badge -->
        <div class="status-section">
            <span class="status-badge large" [class]="'status-' + guest.status">
            {{ getStatusIcon(guest.status) }} {{ getStatusLabel(guest.status) }}
            </span>
        </div>

        <!-- QR Code Section -->
        <div class="qr-section" *ngIf="guest.qrCodeGenerated; else noQr">
            <h3>Code QR</h3>
            <div class="qr-code-container">
            <img [src]="guest.qrCodeUrl" alt="QR Code" class="qr-code-image" />
            <p class="qr-description">Scannez ce code pour accÃ©der Ã  l'invitation</p>
            </div>
            <button class="btn btn-outline" (click)="downloadQRCode()">ğŸ“¥ TÃ©lÃ©charger le QR Code</button>
        </div>

        <ng-template #noQr>
            <div class="no-qr-section">
            <div class="no-qr-icon">ğŸ“±</div>
            <p>Aucun code QR gÃ©nÃ©rÃ© pour cet invitÃ©</p>
            <button class="btn btn-primary" (click)="generateQRCode()">âœ¨ GÃ©nÃ©rer un QR Code</button>
            </div>
        </ng-template>

        <!-- Actions -->
        <div class="modal-actions">
            <button class="btn btn-outline" (click)="closeGuestDetails()">Fermer</button>
            <button class="btn btn-primary" (click)="editGuestFromModal()">âœï¸ Ã‰diter</button>
        </div>
        </div>
    </div>
    </div>
</div>